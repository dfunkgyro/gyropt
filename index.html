<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="GyroTechPro - Discover a gallery of cutting-edge GTP applications with intelligent recommendations">
  <meta name="keywords" content="AI, applications, gallery, tools, games, productivity">
  <meta name="author" content="GTP Team">

  <!-- Open Graph tags for social sharing -->
  <meta property="og:title" content="GyroTechPro Gallery">
  <meta property="og:description" content="Discover cutting-edge applications">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://gyrotechpro.com">

  <title>GyroTechPro</title>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🤖</text></svg>">

  <!-- External CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">

  <!-- Supabase Client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Web App Manifest for PWA -->
  <link rel="manifest" href="manifest.json">

  <!-- Theme color for mobile browsers -->
  <meta name="theme-color" content="#00d9ff">

  <!-- Preconnect to external domains for performance -->
  <link rel="preconnect" href="https://images.unsplash.com">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
</head>
<body>
  <!-- Loading Screen -->
  <div id="loadingScreen" class="loading-screen">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h2>AI Gallery Loading...</h2>
      <p>Preparing your personalized experience</p>
    </div>
  </div>

  <!-- Fixed Header -->
  <header class="fixed-header">
    <div class="header-content">
      <h1 class="header-title">
        <i class="fas fa-robot header-icon"></i>
        AI-Enhanced Gallery
      </h1>
      <div class="header-controls">
        <!-- Search Container -->
        <div class="search-container">
          <i class="fas fa-search search-icon"></i>
          <input
            type="text"
            class="search-input"
            placeholder="Search apps, categories, or features..."
            id="searchInput"
            aria-label="Search gallery items"
            autocomplete="off"
          >
          <button class="search-clear" id="searchClear" aria-label="Clear search">
            <i class="fas fa-times"></i>
          </button>
          <!-- Search Suggestions -->
          <div class="search-suggestions" id="searchSuggestions"></div>
        </div>


        <!-- Updated Header Controls Section -->
<div class="header-controls">
  <!-- Search Container -->
  <div class="search-container">
    <i class="fas fa-search search-icon"></i>
    <input
      type="text"
      class="search-input"
      placeholder="Search apps, categories, or features..."
      id="searchInput"
      aria-label="Search gallery items"
      autocomplete="off"
    >
    <button class="search-clear" id="searchClear" aria-label="Clear search">
      <i class="fas fa-times"></i>
    </button>
    <div class="search-suggestions" id="searchSuggestions"></div>
  </div>

  <!-- Category Filter -->
  <select class="category-filter" id="categoryFilter" aria-label="Filter by category">
    <option value="">All Categories</option>
    <option value="web-apps">Web Apps</option>
    <option value="mobile-apps">Mobile Apps</option>
    <option value="desktop-apps">Desktop Apps</option>
    <option value="games">Games</option>
    <option value="ai-ml">AI & ML</option>
    <option value="productivity">Productivity</option>
  </select>

  <!-- Sort Options -->
  <select class="sort-filter" id="sortFilter" aria-label="Sort applications">
    <option value="name">Name A-Z</option>
    <option value="stars">Most Popular</option>
    <option value="recent">Recently Added</option>
    <option value="rating">Highest Rated</option>
  </select>

  <!-- View Toggle -->
  <div class="view-toggle">
    <button class="view-btn active" data-view="grid" aria-label="Grid view" title="Grid View">
      <i class="fas fa-th"></i>
    </button>
    <button class="view-btn" data-view="list" aria-label="List view" title="List View">
      <i class="fas fa-list"></i>
    </button>
    <button class="view-btn" data-view="compact" aria-label="Compact view" title="Compact View">
      <i class="fas fa-th-large"></i>
    </button>
  </div>

  <!-- Theme Selector -->
  <div class="theme-selector">
    <div class="theme-btn neon active" data-theme="default" title="Neon Theme" tabindex="0" role="button" aria-label="Neon theme"></div>
    <div class="theme-btn dark" data-theme="theme-dark" title="Dark Theme" tabindex="0" role="button" aria-label="Dark theme"></div>
    <div class="theme-btn light" data-theme="theme-light" title="Light Theme" tabindex="0" role="button" aria-label="Light theme"></div>
    <div class="theme-btn cyberpunk" data-theme="theme-cyberpunk" title="Cyber Theme" tabindex="0" role="button" aria-label="Cyber theme"></div>
    <div class="theme-btn ocean" data-theme="theme-ocean" title="Ocean Theme" tabindex="0" role="button" aria-label="Ocean theme"></div>
  </div>

  <!-- Auth Buttons (will be updated by JavaScript, but have defaults) -->
  <div id="authContainer">
    <button class="auth-btn" id="authButton" onclick="window.location.href='/login.html'">
      <i class="fas fa-sign-in-alt"></i>
      <span>Login</span>
    </button>
  </div>

  <!-- User Menu (hidden by default, shown when logged in) -->
  <div class="user-menu" id="userMenuContainer" style="display: none;">
    <button class="user-menu-btn" id="userMenuBtn" aria-label="User menu">
      <i class="fas fa-user"></i>
    </button>
    <div class="user-dropdown" id="userDropdown">
      <a href="/profile.html" class="dropdown-item">
        <i class="fas fa-user-circle"></i> My Profile
      </a>
      <a href="/gtpnotes.html" class="dropdown-item">
        <i class="fas fa-sticky-note"></i> My Notes
      </a>
      <a href="#" class="dropdown-item" onclick="aiAgent.showFavorites()">
        <i class="fas fa-heart"></i> My Favorites
      </a>
      <a href="#" class="dropdown-item" onclick="aiAgent.showAnalytics()">
        <i class="fas fa-chart-line"></i> Analytics
      </a>
      <a href="#" class="dropdown-item" onclick="aiAgent.showSettings()">
        <i class="fas fa-cog"></i> Settings
      </a>
      <div class="dropdown-divider"></div>
      <a href="#" class="dropdown-item" onclick="handleLogout()" style="color: var(--error);">
        <i class="fas fa-sign-out-alt"></i> Logout
      </a>
    </div>
  </div>
</div>

<script>
// Global logout handler
function handleLogout() {
  if (typeof authService !== 'undefined') {
    authService.logout();
  } else {
    window.location.href = '/login.html';
  }
}
</script>

        <!-- Category Filter -->
        <select class="category-filter" id="categoryFilter" aria-label="Filter by category">
          <option value="">All Categories</option>
          <option value="web-apps">Web Apps</option>
          <option value="mobile-apps">Mobile Apps</option>
          <option value="desktop-apps">Desktop Apps</option>
          <option value="games">Games</option>
          <option value="ai-ml">AI & ML</option>
          <option value="productivity">Productivity</option>
        </select>

        <!-- Sort Options -->
        <select class="sort-filter" id="sortFilter" aria-label="Sort applications">
          <option value="name">Name A-Z</option>
          <option value="stars">Most Popular</option>
          <option value="recent">Recently Added</option>
          <option value="rating">Highest Rated</option>
        </select>

        <!-- View Toggle -->
        <div class="view-toggle">
          <button class="view-btn active" data-view="grid" aria-label="Grid view" title="Grid View">
            <i class="fas fa-th"></i>
          </button>
          <button class="view-btn" data-view="list" aria-label="List view" title="List View">
            <i class="fas fa-list"></i>
          </button>
          <button class="view-btn" data-view="compact" aria-label="Compact view" title="Compact View">
            <i class="fas fa-th-large"></i>
          </button>
        </div>

        <!-- Theme Selector -->
        <div class="theme-selector">
          <div class="theme-btn neon active" data-theme="default" title="Neon Theme" tabindex="0" role="button" aria-label="Neon theme"></div>
          <div class="theme-btn dark" data-theme="theme-dark" title="Dark Theme" tabindex="0" role="button" aria-label="Dark theme"></div>
          <div class="theme-btn light" data-theme="theme-light" title="Light Theme" tabindex="0" role="button" aria-label="Light theme"></div>
          <div class="theme-btn cyberpunk" data-theme="theme-cyberpunk" title="Cyber Theme" tabindex="0" role="button" aria-label="Cyber theme"></div>
          <div class="theme-btn ocean" data-theme="theme-ocean" title="Ocean Theme" tabindex="0" role="button" aria-label="Ocean theme"></div>
        </div>

        <!-- User Menu -->
        <div class="user-menu">
          <button class="user-menu-btn" id="userMenuBtn" aria-label="User menu">
            <i class="fas fa-user"></i>
          </button>
          <div class="user-dropdown" id="userDropdown">
            <a href="/profile.html" class="dropdown-item">
              <i class="fas fa-user-circle"></i> My Profile
            </a>
            <a href="/gtpnotes.html" class="dropdown-item">
              <i class="fas fa-sticky-note"></i> My Notes
            </a>
            <a href="#" class="dropdown-item" onclick="aiAgent.showFavorites()">
              <i class="fas fa-heart"></i> My Favorites
            </a>
            <a href="#" class="dropdown-item" onclick="aiAgent.showAnalytics()">
              <i class="fas fa-chart-line"></i> Analytics
            </a>
            <a href="#" class="dropdown-item" onclick="aiAgent.showSettings()">
              <i class="fas fa-cog"></i> Settings
            </a>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item" onclick="aiAgent.exportData()">
              <i class="fas fa-download"></i> Export Data
            </a>
          </div>
        </div>

        <!-- Auth Button (will be dynamically added by script.js) -->
      </div>
    </div>
  </header>

  <!-- AI Status Indicator -->
  <div class="ai-status" id="aiStatus">
    <div class="ai-status-dot"></div>
    <span id="aiStatusText">GTP Ready</span>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Intro Section -->
    <section class="intro-section">
      <h1>GyroTechPro</h1>
      <p>Discover a curated collection of cutting-edge applications with AI-powered personalization, intelligent categorization, and real-time customization features</p>

      <!-- Quick Stats -->
      <div class="quick-stats">
        <div class="stat-item">
          <div class="stat-number" id="totalApps">0</div>
          <div class="stat-label">Total Apps</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="favoriteApps">0</div>
          <div class="stat-label">Favorites</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="categoriesCount">6</div>
          <div class="stat-label">Categories</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="userSessions">1</div>
          <div class="stat-label">Sessions</div>
        </div>
      </div>
    </section>

    <!-- Trending Section -->
    <section class="trending-section" id="trendingSection">
      <div class="section-header">
        <h2><i class="fas fa-fire"></i> Trending Now</h2>
        <button class="see-all-btn" onclick="aiAgent.showTrending()">See All</button>
      </div>
      <div class="trending-carousel" id="trendingCarousel">
        <!-- Trending apps will be populated by JavaScript -->
      </div>
    </section>

    <!-- Search Results Header -->
    <div class="search-results-header" id="searchResultsHeader">
      <div class="search-results-info">
        <div id="searchResultsText">Found 0 apps</div>
        <div class="search-filters-active" id="searchFiltersActive"></div>
      </div>
      <div class="search-results-actions">
        <button class="clear-filters-btn" id="clearFiltersBtn" onclick="aiAgent.clearAllFilters()">
          <i class="fas fa-times"></i> Clear Filters
        </button>
        <button class="back-to-home-btn" onclick="aiAgent.backToHome()">
          <i class="fas fa-home"></i> Back to Home
        </button>
      </div>
    </div>

    <!-- Categories Container -->
    <div id="categoriesContainer">
      <!-- Web Applications Category -->
      <section class="category-section" data-category="web-apps">
        <div class="category-header">
          <i class="fas fa-globe category-icon"></i>
          <div class="category-info">
            <h2 class="category-title">Web Applications</h2>
            <p class="category-description">Browser-based tools and platforms</p>
          </div>
          <div class="category-meta">
            <span class="category-count">0 items</span>
            <button class="category-expand" aria-label="Expand category">
              <i class="fas fa-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="gallery" id="webAppsGallery">
          <!-- Apps populated by JavaScript -->
        </div>
      </section>

      <!-- Mobile Applications Category -->
      <section class="category-section" data-category="mobile-apps">
        <div class="category-header">
          <i class="fas fa-mobile-alt category-icon"></i>
          <div class="category-info">
            <h2 class="category-title">Mobile Applications</h2>
            <p class="category-description">iOS and Android applications</p>
          </div>
          <div class="category-meta">
            <span class="category-count">0 items</span>
            <button class="category-expand" aria-label="Expand category">
              <i class="fas fa-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="gallery" id="mobileAppsGallery">
          <!-- Apps populated by JavaScript -->
        </div>
      </section>

      <!-- Desktop Applications Category -->
      <section class="category-section" data-category="desktop-apps">
        <div class="category-header">
          <i class="fas fa-desktop category-icon"></i>
          <div class="category-info">
            <h2 class="category-title">Desktop Applications</h2>
            <p class="category-description">Cross-platform desktop software</p>
          </div>
          <div class="category-meta">
            <span class="category-count">0 items</span>
            <button class="category-expand" aria-label="Expand category">
              <i class="fas fa-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="gallery" id="desktopAppsGallery">
          <!-- Apps populated by JavaScript -->
        </div>
      </section>

      <!-- Games Category -->
      <section class="category-section" data-category="games">
        <div class="category-header">
          <i class="fas fa-gamepad category-icon"></i>
          <div class="category-info">
            <h2 class="category-title">Games</h2>
            <p class="category-description">Entertainment and interactive experiences</p>
          </div>
          <div class="category-meta">
            <span class="category-count">0 items</span>
            <button class="category-expand" aria-label="Expand category">
              <i class="fas fa-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="gallery" id="gamesGallery">
          <!-- Apps populated by JavaScript -->
        </div>
      </section>

      <!-- AI & ML Category -->
      <section class="category-section" data-category="ai-ml">
        <div class="category-header">
          <i class="fas fa-brain category-icon"></i>
          <div class="category-info">
            <h2 class="category-title">AI & Machine Learning</h2>
            <p class="category-description">Artificial intelligence and ML tools</p>
          </div>
          <div class="category-meta">
            <span class="category-count">0 items</span>
            <button class="category-expand" aria-label="Expand category">
              <i class="fas fa-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="gallery" id="aiMlGallery">
          <!-- Apps populated by JavaScript -->
        </div>
      </section>

      <!-- Productivity Category -->
      <section class="category-section" data-category="productivity">
        <div class="category-header">
          <i class="fas fa-tasks category-icon"></i>
          <div class="category-info">
            <h2 class="category-title">Productivity</h2>
            <p class="category-description">Tools to enhance workflow and efficiency</p>
          </div>
          <div class="category-meta">
            <span class="category-count">0 items</span>
            <button class="category-expand" aria-label="Expand category">
              <i class="fas fa-chevron-down"></i>
            </button>
          </div>
        </div>
        <div class="gallery" id="productivityGallery">
          <!-- Apps populated by JavaScript -->
        </div>
      </section>
    </div>
  </main>

  <!-- Enhanced Chat Interface -->
  <div class="chat-container">
    <button class="chat-toggle" onclick="toggleChat()" aria-label="Open AI chat assistant">
      <i class="fas fa-robot"></i>
      <div class="chat-notification" id="chatNotification">1</div>
    </button>

    <div class="chat-window" id="chatWindow" role="dialog" aria-label="AI Assistant Chat">
      <div class="chat-header">
        <div class="chat-avatar" id="chatAvatar"></div>
        <div class="chat-status">
          <h4 id="aiName">Jimin - AI Assistant</h4>
          <p id="chatStatusText">Ready to help customize your experience</p>
        </div>
        <div class="chat-actions">
          <!-- Language Selector -->
          <div class="language-selector">
            <button class="language-btn" onclick="aiAgent.toggleLanguageDropdown()" id="languageBtn"
                    aria-haspopup="listbox" aria-expanded="false">
              <span class="flag">🇺🇸</span> <span id="currentLanguage">EN</span>
              <i class="fas fa-chevron-down"></i>
            </button>
            <div class="language-dropdown" id="languageDropdown" role="listbox">
              <div class="language-option selected" data-lang="en" data-voice="en-US" role="option">
                <span class="flag">🇺🇸</span> English
              </div>
              <div class="language-option" data-lang="ko" data-voice="ko-KR" role="option">
                <span class="flag">🇰🇷</span> 한국어
              </div>
              <div class="language-option" data-lang="ja" data-voice="ja-JP" role="option">
                <span class="flag">🇯🇵</span> 日本語
              </div>
              <div class="language-option" data-lang="zh" data-voice="zh-CN" role="option">
                <span class="flag">🇨🇳</span> 中文
              </div>
              <div class="language-option" data-lang="es" data-voice="es-ES" role="option">
                <span class="flag">🇪🇸</span> Español
              </div>
            </div>
          </div>

          <!-- Audio Controls -->
          <div class="audio-controls">
            <button class="audio-btn" id="micBtn" onclick="aiAgent.toggleMicrophone()"
                    title="Voice input" aria-label="Toggle microphone">
              <i class="fas fa-microphone"></i>
            </button>
            <button class="audio-btn" id="speakerBtn" onclick="aiAgent.toggleSpeaker()"
                    title="Voice output" aria-label="Toggle speaker">
              <i class="fas fa-volume-up"></i>
            </button>
          </div>

          <button class="chat-action-btn" onclick="clearChat()" title="Clear chat history" aria-label="Clear chat">
            <i class="fas fa-trash"></i>
          </button>
          <button class="chat-action-btn" onclick="exportChat()" title="Export chat" aria-label="Export chat">
            <i class="fas fa-download"></i>
          </button>
          <button class="chat-action-btn" onclick="toggleChat()" title="Close chat" aria-label="Close chat">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <div class="chat-messages" id="chatMessages" role="log" aria-label="Chat messages">
        <!-- Welcome message will be added by JavaScript -->
      </div>

      <div class="chat-input-container">
        <!-- Quick Actions -->
        <div class="quick-actions" id="quickActions">
          <button class="quick-action" onclick="sendQuickMessage('Show me trending apps')">
            📈 Trending
          </button>
          <button class="quick-action" onclick="sendQuickMessage('Change theme to dark')">
            🌙 Dark Theme
          </button>
          <button class="quick-action" onclick="sendQuickMessage('Recommend AI tools')">
            🤖 AI Tools
          </button>
          <button class="quick-action" onclick="sendQuickMessage('Search for games')">
            🎮 Games
          </button>
          <button class="quick-action" onclick="sendQuickMessage('Show my favorites')">
            ❤️ Favorites
          </button>
        </div>

        <!-- Typing Indicator -->
        <div class="typing-indicator" id="typingIndicator">
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>

        <!-- Chat Input -->
        <div class="chat-input">
          <div class="input-wrapper">
            <textarea
              id="chatInput"
              placeholder="Ask me to customize your experience, search for apps, or get recommendations..."
              maxlength="500"
              rows="1"
              aria-label="Chat message input"
            ></textarea>
          </div>
          <button class="send-btn" onclick="sendMessage()" id="sendButton" aria-label="Send message">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <!-- Favorites Modal -->
  <div class="modal" id="favoritesModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-heart"></i> My Favorites</h2>
        <button class="modal-close" onclick="aiAgent.closeModal('favoritesModal')">&times;</button>
      </div>
      <div class="modal-body" id="favoritesContent">
        <!-- Favorites content populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Analytics Modal -->
  <div class="modal" id="analyticsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-chart-line"></i> Usage Analytics</h2>
        <button class="modal-close" onclick="aiAgent.closeModal('analyticsModal')">&times;</button>
      </div>
      <div class="modal-body" id="analyticsContent">
        <!-- Analytics content populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal" id="settingsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-cog"></i> Settings</h2>
        <button class="modal-close" onclick="aiAgent.closeModal('settingsModal')">&times;</button>
      </div>
      <div class="modal-body" id="settingsContent">
        <!-- Settings content populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="supabase-client.js"></script>
  <script src="script.js"></script>
  // Authentication UI Initialization - Add this before closing </body> in index.html
<script>
    // Wait for everything to load
    window.addEventListener('DOMContentLoaded', async function() {
      console.log('DOM loaded, initializing auth...');
      
      // Wait a bit for all scripts to be ready
      await new Promise(resolve => setTimeout(resolve, 100));
      
      try {
        // Check if authService exists
        if (typeof authService === 'undefined') {
          console.error('authService not found!');
          return;
        }
        
        // Initialize auth
        await authService.init();
        
        const authContainer = document.getElementById('authContainer');
        const userMenuContainer = document.getElementById('userMenuContainer');
        
        if (!authContainer || !userMenuContainer) {
          console.error('Auth containers not found');
          return;
        }
        
        if (authService.isAuthenticated()) {
          const profile = authService.getCurrentProfile();
          console.log('User logged in:', profile?.username);
          
          // Hide login, show user menu
          authContainer.style.display = 'none';
          userMenuContainer.style.display = 'block';
          
          // Update user button
          const userMenuBtn = document.getElementById('userMenuBtn');
          if (userMenuBtn && profile) {
            if (profile.avatar_url) {
              userMenuBtn.innerHTML = `<img src="${profile.avatar_url}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;">`;
            } else {
              const initial = (profile.username || 'U')[0].toUpperCase();
              userMenuBtn.innerHTML = initial;
            }
          }
        } else {
          console.log('User not logged in');
          authContainer.style.display = 'block';
          userMenuContainer.style.display = 'none';
        }
        
        // Listen for auth changes
        authService.onAuthStateChange((event, session) => {
          console.log('Auth changed:', event);
          if (event === 'SIGNED_IN') {
            window.location.reload();
          } else if (event === 'SIGNED_OUT') {
            window.location.href = '/login.html';
          }
        });
        
      } catch (error) {
        console.error('Auth init error:', error);
      }
    });
    
    // Global logout function
    async function handleLogout() {
      try {
        if (typeof authService !== 'undefined') {
          await authService.logout();
        } else {
          window.location.href = '/login.html';
        }
      } catch (error) {
        console.error('Logout error:', error);
        window.location.href = '/login.html';
      }
    }
  </script>
</body>
</html>